



<div class="max-w-sm mx-auto p-6 bg-gray-900 rounded-2xl shadow-lg text-white space-y-6 ">
  <!-- Token Swap Section -->
  <div class="space-y-4 relative">
    <!-- switch icon-->
    <div (click)="switchCombination()" class=" cursor-pointer absolute switch">
<svg fill="#fdc800" height="30px" width="30px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M505.752,304.915c-8.331-8.331-21.839-8.331-30.17,0L448,332.497v-225.83C448,47.759,400.241,0,341.333,0 c-58.907,0-106.667,47.759-106.667,106.667v298.667c0,35.343-28.657,64-64,64s-64-28.657-64-64v-225.83l27.582,27.582 c8.331,8.331,21.839,8.331,30.17,0s8.331-21.839,0-30.17l-64-64c-0.004-0.004-0.008-0.007-0.012-0.011 c-0.493-0.492-1.012-0.959-1.551-1.402c-0.247-0.203-0.508-0.379-0.762-0.57c-0.303-0.227-0.6-0.462-0.915-0.673 c-0.304-0.203-0.619-0.379-0.931-0.565c-0.286-0.171-0.565-0.35-0.859-0.507c-0.318-0.17-0.645-0.314-0.97-0.467 c-0.306-0.145-0.608-0.298-0.922-0.428c-0.315-0.13-0.637-0.236-0.957-0.35c-0.337-0.121-0.669-0.25-1.013-0.354 c-0.32-0.097-0.646-0.168-0.969-0.249c-0.351-0.089-0.698-0.187-1.055-0.258c-0.375-0.074-0.753-0.118-1.13-0.173 c-0.311-0.044-0.617-0.104-0.932-0.135c-1.4-0.138-2.811-0.138-4.211,0c-0.316,0.031-0.622,0.09-0.933,0.135 c-0.377,0.054-0.755,0.098-1.13,0.172c-0.358,0.071-0.705,0.169-1.056,0.258c-0.323,0.081-0.648,0.152-0.968,0.249 c-0.345,0.104-0.678,0.234-1.015,0.355c-0.319,0.115-0.641,0.22-0.956,0.35c-0.315,0.13-0.616,0.284-0.923,0.428 c-0.324,0.153-0.651,0.297-0.969,0.467c-0.294,0.158-0.574,0.337-0.86,0.508c-0.311,0.186-0.626,0.362-0.93,0.565 c-0.316,0.211-0.613,0.447-0.917,0.674c-0.253,0.19-0.513,0.366-0.76,0.568c-0.539,0.443-1.058,0.909-1.551,1.402 c-0.004,0.004-0.008,0.007-0.012,0.011l-64,64c-8.331,8.331-8.331,21.839,0,30.17c8.331,8.331,21.839,8.331,30.17,0L64,179.503 v225.83C64,464.241,111.759,512,170.667,512s106.667-47.759,106.667-106.667V106.667c0-35.343,28.657-64,64-64 c35.343,0,64,28.657,64,64v225.83l-27.582-27.582c-8.331-8.331-21.839-8.331-30.17,0c-8.331,8.331-8.331,21.839,0,30.17l64,64 c0.004,0.004,0.008,0.006,0.011,0.01c0.494,0.493,1.012,0.96,1.552,1.403c0.247,0.203,0.507,0.379,0.761,0.569 c0.303,0.227,0.6,0.462,0.915,0.673c0.304,0.203,0.619,0.379,0.93,0.565c0.286,0.171,0.565,0.35,0.86,0.508 c0.317,0.17,0.643,0.313,0.967,0.466c0.308,0.145,0.61,0.299,0.925,0.43c0.314,0.13,0.635,0.235,0.953,0.349 c0.338,0.122,0.672,0.251,1.018,0.356c0.318,0.096,0.642,0.167,0.964,0.248c0.353,0.089,0.701,0.188,1.061,0.259 c0.372,0.074,0.748,0.117,1.122,0.171c0.314,0.045,0.622,0.105,0.941,0.136c0.693,0.068,1.388,0.105,2.083,0.105 c0.007,0,0.015,0.001,0.022,0.001s0.015-0.001,0.022-0.001c0.695-0.001,1.39-0.037,2.083-0.105 c0.318-0.031,0.627-0.091,0.941-0.136c0.375-0.054,0.75-0.097,1.122-0.171c0.359-0.071,0.708-0.17,1.061-0.259 c0.322-0.081,0.645-0.152,0.964-0.248c0.346-0.105,0.68-0.234,1.018-0.356c0.318-0.114,0.639-0.219,0.953-0.349 c0.315-0.131,0.618-0.284,0.925-0.43c0.324-0.153,0.65-0.296,0.967-0.466c0.294-0.158,0.574-0.337,0.86-0.508 c0.311-0.186,0.627-0.362,0.93-0.565c0.315-0.211,0.612-0.446,0.915-0.673c0.254-0.19,0.514-0.366,0.761-0.569 c0.54-0.443,1.059-0.91,1.552-1.403c0.004-0.004,0.008-0.006,0.011-0.01l64-64C514.083,326.754,514.083,313.246,505.752,304.915z"></path> </g> </g> </g></svg>
    </div>
    <!-- From Token (Editable) -->
    <div class="flex items-center justify-between p-4 bg-gray-800 rounded-xl">
      <div class="flex items-center space-x-2">
        <div (click)="openPopup('fromTokenSelector')" class="relative">
          <img [src]="combination.sourceNetwork.logo" alt="USDT" class="w-8 h-8 rounded-full" />
          <img [src]="combination.sourceToken.icon_url" alt="BSC" class="w-4 h-4 absolute bottom-[-6px] right-[-8px] rounded-full " />
        </div>
        <span class="text-lg font-semibold">{{combination.sourceToken.token_symbol}}</span>
      </div>
      <div class="text-right">
        <input
          type="number"
          [value]="combination.amount"
          (change)='updateAmount($event)'
          class="bg-transparent text-xl font-bold text-right w-24 focus:outline-none"
        />
        <div class="text-sm text-gray-400">{{getTokensUsdPrice('from',combination.sourceToken,combination.amount)|number:'1.0-2'}} $</div>
      </div>
    </div>

    <!-- To Token (Read-only) -->
    <div class="flex items-center justify-between p-4 bg-gray-800 rounded-xl">
      <div class="flex items-center space-x-2">
        <div (click)="openPopup('toTokenSelector')" class="relative">
          <img [src]="combination.destinationNetwork.logo" alt="BNB" class="w-8 h-8 rounded-full" />
          <img [src]="combination.destinationToken.icon_url" alt="BSC" class="w-4 h-4 absolute bottom-[-6px] right-[-8px] rounded-full " />
        </div>
        <span class="text-lg font-semibold">{{combination.destinationToken.token_symbol}}</span>
      </div>
      <div class="text-right">
        <div class="text-xl font-bold">{{activeQuote?.toAmount|number:'1.0-4'}}</div>
        <div class="text-sm text-gray-400">{{getTokensUsdPrice('to',combination.destinationToken,activeQuote?.toAmount||0)|number:'1.1-2'}} $</div>
      </div>
    </div>
  </div>

  <!-- Recipient Address Input -->
  <div class="space-y-2">
    <label for="recipient" class="text-sm text-gray-300">Recipient Address</label>
    <input
      type="text"
      id="recipient"
      placeholder="Enter recipient wallet address"
      [(value)]="recipientAddress"
      (blur)="updateRecipientAddress($event)"
      class="w-full p-3 bg-gray-800 text-white rounded-xl placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-yellow-400"
    />
    <label class=" text-red-400" *ngIf="activeQuote?.exchangeInfo?.keyword=='JUPITER'">recipient address should be same as source address in case of jupiter</label>
  </div>

  <!-- Price Details -->
  <div *ngIf="activeQuote && !activeQuote.err" class="text-sm text-gray-300 space-y-2">
    <div class="flex justify-between">
      <span>Min Received</span>
      <span class="text-white font-medium">{{activeQuote?.additionalInfo?.minRecieved|number:'1.2-3'}} {{!activeQuote.additionalInfo.minRecieved?'Market Price':activeQuote.toTokenInfo.token_symbol}}</span>
    </div>
    <div class="flex justify-between">
      <span>Difference</span>
      <span class="text-white font-medium">{{ getNegativeValue(activeQuote?.additionalInfo?.priceImpactWithoutGasFee) ? '' : '+'}}{{ getNegativeValue(activeQuote?.additionalInfo?.priceImpactWithoutGasFee) | number:'0.1-1'}}%</span>
    </div>
    <div class="flex justify-between">
      <span> 1 {{ activeQuote?.toTokenInfo?.token_symbol }} <span *ngIf="!isBridge(activeQuote)">BUY</span> <span *ngIf="isBridge(activeQuote)">AVG.</span> PRICE</span>
      <span class="text-white font-medium">  ~ ${{ activeQuote?.additionalInfo?.avgPrice['to'] |  number:'1.0-4'}}</span>
    </div>
    <div class="flex justify-between">
      <span> 1 {{ activeQuote?.fromTokenInfo?.token_symbol }} Sell Price</span>
      <span class="text-white font-medium"> ~ ${{ activeQuote?.additionalInfo?.avgPrice['from'] |  number:'1.0-4'}}</span>
    </div>
  </div>

  <!-- Buy Button -->
  <button [disabled]="recipientAddress.length===0 && buttonName==='Swap'" (click)="buttonClicked()" [ngClass]="recipientAddress.length===0 && buttonName=='Swap'?'cursor-not-allowed':'cursor-pointer'" class="w-full  py-3 bg-yellow-400 hover:bg-yellow-300 text-black font-semibold rounded-xl transition duration-200">
    {{this.buttonName}}
  </button>
  <div *ngIf="recipientAddress.length>0 && ['Swap','Change Network'].includes(this.buttonName)" class="bg-gray-800 rounded-md p-4 text-sm text-gray-300">
    <div class="text-white font-semibold mb-2 flex justify-between items-center">
      Swap API Payload
      <span (click)="copyPayload()" class="tooltip cursor-pointer" data-tip="Click to copy payload">
        <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 18 20">
          <path
            d="M16 1h-3.278A1.992 1.992 0 0 0 11 0H7a1.993 1.993 0 0 0-1.722 1H2a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2Zm-3 14H5a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2Zm0-4H5a1 1 0 0 1 0-2h8a1 1 0 1 1 0 2Zm0-5H5a1 1 0 0 1 0-2h2V2h4v2h2a1 1 0 1 1 0 2Z" />
        </svg>
      </span>
    </div>
  
    <div class="bg-gray-900 rounded-md p-3 max-h-[200px] overflow-y-auto text-xs leading-relaxed text-yellow-300 font-mono whitespace-pre-wrap break-all">
      {{ postQuotationSample | json }}
    </div>
  </div>
</div>

